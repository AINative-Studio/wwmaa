# Railway Configuration for WWMAA
# Reference: https://docs.railway.app/deploy/config-as-code

[build]
builder = "NIXPACKS"
buildCommand = "pip install --upgrade pip && pip install -r backend/requirements.txt"

[deploy]
startCommand = "uvicorn backend.app:app --host 0.0.0.0 --port $PORT --workers 2"
healthcheckPath = "/api/health"
healthcheckTimeout = 100
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3

# Staging environment specific configuration
[staging]
numReplicas = 1
region = "us-west1"

[staging.healthcheck]
path = "/api/health"
timeout = 100
interval = 30

# Production environment specific configuration
[production]
numReplicas = 2
region = "us-west1"
autoScaling = true
minReplicas = 2
maxReplicas = 4

[production.healthcheck]
path = "/api/health"
timeout = 100
interval = 30
